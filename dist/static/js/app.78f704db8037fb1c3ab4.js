webpackJsonp([1],{NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("7+uW"),i=a("zL8q"),s=a.n(i),o=(a("tvR6"),{render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]}),r=a("VU/8")({name:"App",components:{},data:function(){return{path:""}},mounted:function(){this.path=this.$route.path},watch:{$route:function(t,e){this.path=t.path}}},o,!1,null,null,null).exports,l=a("/ocq"),c=a("//Fk"),u=a.n(c),d=a("mtWM"),h=a.n(d).a.create({baseURL:"http://118.31.23.47:12480",timeout:5e6});console.log(h),h.interceptors.request.use(function(t){return t.headers["Content-Type"]="application/json",t},function(t){return console.log(t),u.a.reject(t)}),h.interceptors.response.use(function(t){var e=t.data;return!0===e.Result||1===e.status?(e.token=t.headers.token,e):200!==t.status?(Object(i.Message)({message:e.message||"Error",type:"error",duration:5e3}),50008!==e.code&&50012!==e.code&&50014!==e.code||i.MessageBox.confirm("您已注销，您可以取消停留在此页，或重新登录","确认注销",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then(function(){}),u.a.reject(new Error(e.message||"Error"))):e},function(t){return console.log("err"+t),Object(i.Message)({message:t.message,type:"error",duration:5e3}),u.a.reject(t)});a("lHA8"),a("c/Tr"),a("fZjL"),a("pFYg");function p(t){return("00"+t).substr(t.length)}var m=a("7t+N"),b=a.n(m),f=a("XLwt"),v=a.n(f),g={data:function(){return{$_sidebarElm:null}},mounted:function(){var t,e,a,n,i,s,o,r,l,c=this;this.__resizeHandler=(t=function(){c.chart&&c.chart.resize()},e=100,n=void 0,i=void 0,s=void 0,o=void 0,r=void 0,l=function l(){var c=+new Date-o;c<e&&c>0?n=setTimeout(l,e-c):(n=null,a||(r=t.apply(s,i),n||(s=i=null)))},function(){for(var i=arguments.length,c=Array(i),u=0;u<i;u++)c[u]=arguments[u];s=this,o=+new Date;var d=a&&!n;return n||(n=setTimeout(l,e)),d&&(r=t.apply(s,c),s=c=null),r}),window.addEventListener("resize",this.__resizeHandler),this.$_sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.$_sidebarElm&&this.$_sidebarElm.addEventListener("transitionend",this.$_sidebarResizeHandler)},beforeDestroy:function(){window.removeEventListener("resize",this.__resizeHandler),this.$_sidebarElm&&this.$_sidebarElm.removeEventListener("transitionend",this.$_sidebarResizeHandler)},methods:{$_sidebarResizeHandler:function(t){"width"===t.propertyName&&this.__resizeHandler()}}};a("tcAE");var _={mixins:[g],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"300px"},PieScienceList:{type:Array,require:!0},tit:{type:String}},watch:{PieScienceList:{deep:!0,handler:function(t){this.initChart()}}},data:function(){return{chart:null}},mounted:function(){var t=this;this.$nextTick(function(){t.initChart()})},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){if(this.chart=v.a.init(this.$el,"macarons"),void 0!==this.PieScienceList&&this.PieScienceList.length){var t=[],e=[];this.PieScienceList.forEach(function(a,n){t.push(a.name);var i={value:a.count,name:a.name};e.push(i)}),this.chart.setOption({title:{text:this.tit,bottom:0,x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{top:"10",data:t},series:[{name:"借书",type:"pie",radius:"55%",center:["50%","60%"],data:e,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})}}}},y={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{class:this.className,style:{height:this.height,width:this.width}})},staticRenderFns:[]},x=a("VU/8")(_,y,!1,null,null,null).exports,w={name:"Toplist",components:{pieChart:x},data:function(){return{chartData:[],bookcaseTable:[],borrowingTable:[],schooleTable:[],loading:!1}},methods:{next:function(){this.$router.push({path:"/statistical"})},getData:function(){this.loading=!0;var t=this;b.a.ajax({type:"post",url:"http://118.31.23.47:12480/api/manage/countinfo",data:{access_token:"dc28e916633d6d7346a684187c4cf028",p:"115533"},dataType:"json",success:function(e){var a=e.data.data;a.category_data.forEach(function(e,a){var n={name:e.manufacturer||"标记",total:e.bookcasecount,count:e.bookcasecount-e.offlinecount};t.chartData.push(n),t.bookcaseTable.push(n)}),a.lend_now_data.forEach(function(e,a){if(a>20)return!1;var n=new Date(parseInt(e.lend_time+"000")),i={cabinet:e.lend_bookcase_no,name:e.reader_name,time:function(t,e){/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));var a={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};for(var n in a)if(new RegExp("("+n+")").test(e)){var i=a[n]+"";e=e.replace(RegExp.$1,1===RegExp.$1.length?i:p(i))}return e}(n,"yyyy-MM-dd hh:mm")};t.borrowingTable.push(i)}),a.school_data.forEach(function(e,a){var n={name:e.name,cabinetNum:e.bookcaseinfo[0].bookcasecount,studentNum:e.studentinfo[0].studentcount,borrowingNum:e.depositreturninfo[0].depositreturncount,depositNum:e.depositinfo[0].studentdepositcount,refundNum:e.lendinfo[0].lendcount};t.schooleTable.push(n)}),t.loading=!1}})}},mounted:function(){this.getData()}},S={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"layer"},[a("el-button",{attrs:{type:"info"},on:{click:t.next}},[t._v("下一页")]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"Home"},[a("div",{staticClass:"bookcase"},[a("div",{staticClass:"bookcase-charts"},[a("div",{staticStyle:{"text-align":"center"}},[a("span",[t._v("书柜统计")]),t._v(" "),a("div",{staticClass:"bookcase-chart"},[a("div",{staticClass:"pieChart"},[a("pieChart",{staticStyle:{width:"100%"},attrs:{PieScienceList:t.chartData,tit:"书柜在线"}})],1)]),t._v(" "),a("div",{staticClass:"bookcase-table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.bookcaseTable,border:""}},[a("el-table-column",{attrs:{prop:"name",label:"厂商"}}),t._v(" "),a("el-table-column",{attrs:{prop:"total",label:"总数"}}),t._v(" "),a("el-table-column",{attrs:{prop:"count",label:"在线数量"}})],1)],1)])]),t._v(" "),a("div",{staticClass:"bookcase-recent",staticStyle:{"text-align":"center"}},[a("span",[t._v("近期借阅")]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.borrowingTable,border:""}},[a("el-table-column",{attrs:{prop:"cabinet",label:"柜子"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"借阅信息（借阅人图书）"}}),t._v(" "),a("el-table-column",{attrs:{prop:"time",label:"借阅时间"}})],1)],1)]),t._v(" "),a("div",{staticClass:"school-statistics",staticStyle:{"text-align":"center"}},[a("span",[t._v("学校借阅")]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.schooleTable,border:""}},[a("el-table-column",{attrs:{prop:"name",label:"学校"}}),t._v(" "),a("el-table-column",{attrs:{prop:"cabinetNum",label:"柜子数量"}}),t._v(" "),a("el-table-column",{attrs:{prop:"studentNum",label:"学生数量"}}),t._v(" "),a("el-table-column",{attrs:{prop:"refundNum",label:"借阅统计"}}),t._v(" "),a("el-table-column",{attrs:{prop:"depositNum",label:"押金缴纳"}}),t._v(" "),a("el-table-column",{attrs:{label:"退款统计"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(null===e.row.borrowingNum?"0":Math.ceil(e.row.borrowingNum)))]}}])})],1)],1)])],1)},staticRenderFns:[]};var C=a("VU/8")(w,S,!1,function(t){a("k2Dr")},null,null).exports;a("tcAE");var E={mixins:[g],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"350px"},autoResize:{type:Boolean,default:!0},tit:{type:String},lienList:{type:Object,required:!0}},data:function(){return{chart:null}},watch:{lienList:{deep:!0,handler:function(t){this.setOptions(t)}}},mounted:function(){var t=this;this.$nextTick(function(){t.initChart()})},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){this.chart=v.a.init(this.$el,"macarons"),void 0!==this.lienList&&(console.log(this.tit),this.setOptions(this.lienList))},setOptions:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.countVal,a=t.countYear;this.chart.setOption({title:{text:this.tit,textStyle:{fontSize:12}},xAxis:{data:a,boundaryGap:!1,axisTick:{show:!1}},grid:{left:10,right:20,bottom:20,top:50,containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"cross"},padding:[5,10]},yAxis:{axisTick:{show:!1}},series:[{name:this.tit,itemStyle:{normal:{color:"#FF005A",lineStyle:{color:"#FF005A",width:2}}},smooth:!0,type:"line",data:e,animationDuration:2800,animationEasing:"cubicInOut"}]})}}},k={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{class:this.className,style:{height:this.height,width:this.width}})},staticRenderFns:[]},D=a("VU/8")(E,k,!1,null,null,null).exports;a("tcAE");var T={mixins:[g],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"400px"},barData:{type:Object},tit:{type:String}},watch:{barData:{deep:!0,handler:function(t){this.initChart()}}},data:function(){return{chart:null}},mounted:function(){var t=this;this.$nextTick(function(){t.initChart()})},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){this.chart=v.a.init(this.$el,"macarons"),this.chart.setOption({color:["#3398DB"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:this.barData.xData,axisLabel:{inierval:0,rotate:45},axisTick:{alignWithLabel:!0}}],yAxis:[{type:"value"}],series:[{name:"借阅次数",type:"bar",barWidth:"80%",data:this.barData.yData}]})}}},$={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{class:this.className,style:{height:this.height,width:this.width}})},staticRenderFns:[]},N={name:"Statistical",components:{pieChart:x,barChart:a("VU/8")(T,$,!1,null,null,null).exports,lineChart:D},data:function(){return{lendcount:{countVal:[],countYear:[]},barData:{xData:[],yData:[]},chartData:[{name:"ada",count:5},{name:"ada",count:6},{name:"ada",count:7},{name:"ada",count:8}],bookcaseTable:[],depositcount:{countVal:[],countYear:[]},channelcount:{countVal:[],countYear:[]},deposit:0,channel:0,loading:!1}},methods:{back:function(){this.$router.push({path:"/"})},getData:function(){var t=this;this.loading=!0;b.a.ajax({type:"post",url:"http://118.31.23.47:12480/api/manage/countinfo",data:{p:"115533",access_token:"ecbbeee3af52a5c92d04de31c969636d",type:2},dataType:"json",success:function(e){t.loading=!1,e.data.data.time_data.forEach(function(e,a){t.lendcount.countVal.push(e.lendcount),t.lendcount.countYear.push(e.day),t.depositcount.countVal.push(e.depositcount),t.depositcount.countYear.push(e.day),t.channelcount.countVal.push(e.channelcount),t.channelcount.countYear.push(e.day)}),e.data.data.school_data.forEach(function(e,a){t.barData.xData.push(e.name),t.barData.yData.push(e.lendinfo)}),t.bookcaseTable=e.data.data.lend_marc_data,t.deposit=e.data.data.deposit_count[0].deposit,t.channel=e.data.data.channel_count[0].channel}})}},mounted:function(){this.getData()}},L={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"layer"},[a("el-button",{attrs:{type:"info"},on:{click:t.back}},[t._v("返回")]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"statistical"},[a("div",{staticClass:"deposit"},[a("div",{staticClass:"deposit-charts"},[a("div",{staticStyle:{"text-align":"center"}},[a("span",[t._v("借阅统计-按时间")]),t._v(" "),a("lineChart",{attrs:{lienList:t.lendcount}}),t._v(" "),a("span",[t._v("借阅统计-按学校")]),t._v(" "),a("barChart",{attrs:{barData:t.barData}})],1)]),t._v(" "),a("div",{staticClass:"deposit-table",staticStyle:{"text-align":"center"}},[a("span",[t._v("借阅统计-最受欢迎图书")]),t._v(" "),a("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.bookcaseTable,border:""}},[a("el-table-column",{attrs:{prop:"title",label:"书名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"marc_id",label:"ISBN"}}),t._v(" "),a("el-table-column",{attrs:{prop:"lendcount",label:"借阅次数"}})],1)],1)]),t._v(" "),a("div",{staticClass:"borrowing"},[a("div",{staticClass:"borrowinginfo",staticStyle:{"text-align":"center"}},[a("span",[t._v("押金统计")]),t._v(" "),a("div",{staticClass:"info"},[a("div",[a("span",[t._v("总押金")]),t._v(" "),a("p",[t._v(t._s(Math.ceil(t.deposit)))])]),t._v(" "),a("div",[a("span",[t._v("退款")]),t._v(" "),a("p",[t._v(t._s(Math.ceil(t.channel)))])])])]),t._v(" "),a("div",{staticClass:"borrowingchart"},[a("lineChart",{staticStyle:{"margin-top":"40px"},attrs:{height:"400px",lienList:t.depositcount,tit:"押金"}}),t._v(" "),a("lineChart",{staticStyle:{"margin-top":"40px"},attrs:{height:"400px",lienList:t.channelcount,tit:"退款"}})],1)])])],1)},staticRenderFns:[]};var R=a("VU/8")(N,L,!1,function(t){a("P1PN")},null,null).exports;n.default.use(l.a);var A=new l.a({routes:[{path:"/",name:"Home",component:C},{path:"/statistical",name:"statistical",component:R}]}),j=a("NYxO");n.default.use(j.a);var O=new j.a.Store({state:{bAuth:!1},mutations:{loginStatue:function(t,e){t.bAuth=e}}}),z=(a("j1ja"),a("Yg9U")),F=a.n(z);a("yh13");n.default.config.productionTip=!1,n.default.use(s.a),n.default.use(F.a),A.beforeEach(function(t,e,a){t.meta.requiresAuth?O.state.bAuth?a():(alert("请先登录"),a("/Login")):a(),document.body.scrollTop=0,document.documentElement.scrollTop=0,window.pageYOffset=0,a()}),new n.default({el:"#app",router:A,components:{App:r},template:"<App/>"})},P1PN:function(t,e){},k2Dr:function(t,e){},tvR6:function(t,e){},yh13:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.78f704db8037fb1c3ab4.js.map